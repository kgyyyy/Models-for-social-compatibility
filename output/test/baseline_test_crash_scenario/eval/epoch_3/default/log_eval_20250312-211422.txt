2025-03-12 21:14:22,192   INFO  **********************Start logging**********************
2025-03-12 21:14:22,192   INFO  CUDA_VISIBLE_DEVICES=ALL
2025-03-12 21:14:22,192   INFO  cfg_file         cfgs/social_aware/mtr_social_aware_test.yaml
2025-03-12 21:14:22,192   INFO  batch_size       64
2025-03-12 21:14:22,192   INFO  workers          4
2025-03-12 21:14:22,192   INFO  extra_tag        baseline_test_2
2025-03-12 21:14:22,192   INFO  ckpt             ../output/social_aware/mtr_baseline_train/result_baseline_3/ckpt/best_model.pth
2025-03-12 21:14:22,192   INFO  launcher         none
2025-03-12 21:14:22,192   INFO  tcp_port         18888
2025-03-12 21:14:22,192   INFO  local_rank       0
2025-03-12 21:14:22,192   INFO  fix_random_seed  False
2025-03-12 21:14:22,192   INFO  set_cfgs         None
2025-03-12 21:14:22,192   INFO  max_waiting_mins 30
2025-03-12 21:14:22,192   INFO  start_epoch      0
2025-03-12 21:14:22,192   INFO  eval_tag         default
2025-03-12 21:14:22,192   INFO  eval_all         False
2025-03-12 21:14:22,192   INFO  ckpt_dir         None
2025-03-12 21:14:22,192   INFO  save_to_file     False
2025-03-12 21:14:22,192   INFO  cfg.ROOT_DIR: /home/ljh/MTR
2025-03-12 21:14:22,192   INFO  cfg.LOCAL_RANK: 0
2025-03-12 21:14:22,192   INFO  
cfg.DATA_CONFIG = edict()
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.DATASET: social_awareDataset
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.OBJECT_TYPE: ['TYPE_VEHICLE']
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.DATA_ROOT: data/social_aware
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.train_data_dir: data/social_aware/data_train.pkl
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.raw_train_data_dir: data/social_aware/data_raw_train.pkl
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.val_data_dir: data/social_aware/crash_data_all_test.pkl
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.raw_val_data_dir: data/social_aware/crash_data_all_raw.pkl
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.test_data_dir: None
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.raw_test_data_dir: None
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.reuse_temp_file: True
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.map_data_dir: data/social_aware/map.pkl
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.core_num: 24
2025-03-12 21:14:22,192   INFO  
cfg.DATA_CONFIG.SAMPLE_INTERVAL = edict()
2025-03-12 21:14:22,192   INFO  cfg.DATA_CONFIG.SAMPLE_INTERVAL.train: 5
2025-03-12 21:14:22,193   INFO  cfg.DATA_CONFIG.SAMPLE_INTERVAL.test: 1
2025-03-12 21:14:22,193   INFO  cfg.DATA_CONFIG.POINT_SAMPLED_INTERVAL: 1
2025-03-12 21:14:22,193   INFO  cfg.DATA_CONFIG.NUM_POINTS_EACH_POLYLINE: 20
2025-03-12 21:14:22,193   INFO  cfg.DATA_CONFIG.VECTOR_BREAK_DIST_THRESH: 1.0
2025-03-12 21:14:22,193   INFO  cfg.DATA_CONFIG.NUM_OF_SRC_POLYLINES: 768
2025-03-12 21:14:22,193   INFO  cfg.DATA_CONFIG.CENTER_OFFSET_OF_MAP: [10.0, 0]
2025-03-12 21:14:22,193   INFO  
cfg.MODEL = edict()
2025-03-12 21:14:22,193   INFO  
cfg.MODEL.CONTEXT_ENCODER = edict()
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.NAME: MTREncoder
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.NUM_OF_ATTN_NEIGHBORS: 16
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.NUM_INPUT_ATTR_AGENT: 10
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.NUM_INPUT_ATTR_MAP: 12
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.NUM_CHANNEL_IN_MLP_AGENT: 256
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.NUM_CHANNEL_IN_MLP_MAP: 64
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.NUM_LAYER_IN_MLP_AGENT: 3
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.NUM_LAYER_IN_MLP_MAP: 5
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.NUM_LAYER_IN_PRE_MLP_MAP: 3
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.D_MODEL: 256
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.NUM_ATTN_LAYERS: 6
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.NUM_ATTN_HEAD: 8
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.DROPOUT_OF_ATTN: 0.1
2025-03-12 21:14:22,193   INFO  cfg.MODEL.CONTEXT_ENCODER.USE_LOCAL_ATTN: True
2025-03-12 21:14:22,193   INFO  
cfg.MODEL.MOTION_DECODER = edict()
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.NAME: MTRDecoder
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.OBJECT_TYPE: ['TYPE_VEHICLE']
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.CENTER_OFFSET_OF_MAP: [10.0, 0]
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.NUM_FUTURE_FRAMES: 100
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.NUM_MOTION_MODES: 6
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.INTENTION_POINTS_FILE: data/waymo/cluster_64_center_dict.pkl
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.D_MODEL: 512
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.NUM_DECODER_LAYERS: 6
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.NUM_ATTN_HEAD: 8
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.MAP_D_MODEL: 256
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.DROPOUT_OF_ATTN: 0.1
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.NUM_BASE_MAP_POLYLINES: 256
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.NUM_WAYPOINT_MAP_POLYLINES: 128
2025-03-12 21:14:22,193   INFO  
cfg.MODEL.MOTION_DECODER.LOSS_WEIGHTS = edict()
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.LOSS_WEIGHTS.cls: 1.0
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.LOSS_WEIGHTS.reg: 1.0
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.LOSS_WEIGHTS.vel: 0.5
2025-03-12 21:14:22,193   INFO  cfg.MODEL.MOTION_DECODER.NMS_DIST_THRESH: 2.5
2025-03-12 21:14:22,193   INFO  
cfg.OPTIMIZATION = edict()
2025-03-12 21:14:22,193   INFO  cfg.OPTIMIZATION.BATCH_SIZE_PER_GPU: 10
2025-03-12 21:14:22,193   INFO  cfg.OPTIMIZATION.NUM_EPOCHS: 30
2025-03-12 21:14:22,193   INFO  cfg.OPTIMIZATION.OPTIMIZER: AdamW
2025-03-12 21:14:22,193   INFO  cfg.OPTIMIZATION.LR: 0.0003
2025-03-12 21:14:22,193   INFO  cfg.OPTIMIZATION.WEIGHT_DECAY: 0.01
2025-03-12 21:14:22,193   INFO  cfg.OPTIMIZATION.SCHEDULER: lambdaLR
2025-03-12 21:14:22,193   INFO  cfg.OPTIMIZATION.DECAY_STEP_LIST: [100, 125, 150, 175]
2025-03-12 21:14:22,193   INFO  cfg.OPTIMIZATION.LR_DECAY: 0.5
2025-03-12 21:14:22,193   INFO  cfg.OPTIMIZATION.LR_CLIP: 1e-06
2025-03-12 21:14:22,193   INFO  cfg.OPTIMIZATION.GRAD_NORM_CLIP: 1000
2025-03-12 21:14:22,193   INFO  cfg.TAG: mtr_social_aware_test
2025-03-12 21:14:22,193   INFO  cfg.EXP_GROUP_PATH: social_aware
2025-03-12 21:14:22,436   INFO  ==> Loading parameters from checkpoint ../output/social_aware/mtr_baseline_train/result_baseline_3/ckpt/best_model.pth to GPU
2025-03-12 21:14:22,558   INFO  ==> Checkpoint trained from version: none
2025-03-12 21:14:22,559   INFO  The number of disk ckpt keys: 842
2025-03-12 21:14:22,607   INFO  Missing keys: []
2025-03-12 21:14:22,607   INFO  The number of missing keys: 0
2025-03-12 21:14:22,607   INFO  The number of unexpected keys: 0
2025-03-12 21:14:22,607   INFO  ==> Done (total keys 842)
2025-03-12 21:14:22,658   INFO  *************** LOAD MODEL (epoch=109, iter=2750) for EVALUATION *****************
2025-03-12 21:14:22,658   INFO  *************** EPOCH 3 EVALUATION *****************
2025-03-12 21:14:23,045   INFO  eval: epoch=3, batch_iter=0/13, batch_size=64, iter_cost=0.39s, time_cost: 00:00/00:05, 
2025-03-12 21:14:24,208   INFO  eval: epoch=3, batch_iter=12/13, batch_size=60, iter_cost=0.13s, time_cost: 00:01/00:00, 
2025-03-12 21:14:24,221   INFO  *************** Performance of EPOCH 3 *****************
2025-03-12 21:14:24,221   INFO  Generate label finished(sec_per_example: 0.0019 second).
2025-03-12 21:14:24,575   INFO  Evaluation Metrics:
----------------------------------------
40_minADE: 1.1658
40_minFDE: 2.9269
40_MR: 0.2742
40_p-minADE: 3.3660
40_p-minFDE: 5.1270
40_p-MR: 0.8210
40_brier-minADE: 1.8995
40_brier-minFDE: 3.6605
----------------------------------------

2025-03-12 21:14:24,575   INFO  Result is save to /home/ljh/MTR/output/social_aware/mtr_social_aware_test/baseline_test_2/eval/epoch_3/default
2025-03-12 21:14:24,575   INFO  ****************Evaluation done.*****************
